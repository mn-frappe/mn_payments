{
 "doctype": "DocType",
 "name": "Payment Transaction",
 "module": "MN Payments",
 "istable": 0,
 "editable_grid": 1,
 "engine": "InnoDB",
 "field_order": [
  "status",
  "provider",
  "reference_doctype",
  "reference_name",
  "payer_email",
  "payer_type",
  "entity_registration",
  "entity_name",
  "subscription_plan",
  "section_amounts",
  "amount",
  "special_tax",
  "city_tax",
  "total",
  "currency",
  "section_gateway",
  "qpay_invoice_id",
  "qr_text",
  "qr_image",
  "retain_sensitive",
  "webhook_signature",
  "section_meta",
  "callback_payload",
  "error_log"
 ],
 "fields": [
  {"fieldname": "status", "fieldtype": "Select", "label": "Status", "options": "Draft\nPending\nPaid\nFailed\nExpired\nCancelled", "default": "Draft", "in_list_view": 1},
  {"fieldname": "provider", "fieldtype": "Link", "label": "Payment Provider", "options": "Payment Provider", "reqd": 1},
  {"fieldname": "reference_doctype", "fieldtype": "Link", "label": "Reference DocType"},
  {"fieldname": "reference_name", "fieldtype": "Dynamic Link", "label": "Reference Name", "options": "reference_doctype"},
  {"fieldname": "payer_email", "fieldtype": "Data", "label": "Payer Email", "reqd": 1, "in_list_view": 1},
  {"fieldname": "payer_type", "fieldtype": "Select", "label": "Payer Type", "options": "Individual\nEntity", "default": "Individual"},
  {"fieldname": "entity_registration", "fieldtype": "Data", "label": "Entity Registration No", "depends_on": "eval:doc.payer_type=='Entity'"},
  {"fieldname": "entity_name", "fieldtype": "Data", "label": "Entity Name", "depends_on": "eval:doc.payer_type=='Entity'"},
  {"fieldname": "subscription_plan", "fieldtype": "Link", "label": "Subscription Plan", "options": "Subscription Plan"},
  {"fieldname": "section_amounts", "fieldtype": "Section Break", "label": "Amounts"},
  {"fieldname": "amount", "fieldtype": "Currency", "label": "Base Amount", "reqd": 1},
  {"fieldname": "special_tax", "fieldtype": "Currency", "label": "Special Tax"},
  {"fieldname": "city_tax", "fieldtype": "Currency", "label": "City Tax"},
  {"fieldname": "total", "fieldtype": "Currency", "label": "Total Amount"},
  {"fieldname": "currency", "fieldtype": "Data", "label": "Currency", "default": "MNT"},
  {"fieldname": "section_gateway", "fieldtype": "Section Break", "label": "Gateway Data"},
  {"fieldname": "qpay_invoice_id", "fieldtype": "Data", "label": "QPay Invoice ID", "in_list_view": 1},
  {"fieldname": "qr_text", "fieldtype": "Small Text", "label": "QR Text", "depends_on": "eval:doc.retain_sensitive==1"},
  {"fieldname": "qr_image", "fieldtype": "Long Text", "label": "QR Image (base64)", "depends_on": "eval:doc.retain_sensitive==1"},
  {"fieldname": "retain_sensitive", "fieldtype": "Check", "label": "Retain Sensitive Data", "default": "0", "description": "Unchecked for Individuals"},
  {"fieldname": "webhook_signature", "fieldtype": "Data", "label": "Webhook Signature"},
  {"fieldname": "section_meta", "fieldtype": "Section Break", "label": "Meta"},
  {"fieldname": "callback_payload", "fieldtype": "Long Text", "label": "Callback Payload (scrubbed)"},
  {"fieldname": "error_log", "fieldtype": "Long Text", "label": "Error Log"}
 ],
 "permissions": [
  {"role": "System Manager", "read": 1, "write": 1, "create": 1, "delete": 1, "print": 1, "email": 1, "share": 1, "export": 1}
 ],
 "sort_field": "modified",
 "sort_order": "DESC",
 "track_changes": 1,
 "quick_entry": 1
}
